<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 해당 파일에 모든 쿼리문을 작성 -->
<mapper namespace="empMapper">
	<resultMap type="com.study.test.emp.vo.EmpVO" id="emp">
		<result column="EMP_NO"	  property="empNo"/>
		<result column="EMP_TYPE" property="empType"/>
		<result column="MEM_NO"   property="memNo"/>
		<result column="DEPT_NO"  property="deptNo"/>
		<result column="COLL_NO"  property="collNo"/>
	</resultMap>

	<resultMap type="com.study.test.emp.vo.LectureVO" id="lecture">
		<result column="LEC_NO" 	 property="lecNo"/>
		<result column="LEC_NAME"    property="lecName"/>
		<result column="LEC_SCORE"   property="lecScore"/>
		<result column="CREATE_DATE" property="createDate"/>
		<result column="MAX_NUM" 	 property="maxNum"/>
		<result column="NOW_NUM" 	 property="nowNum"/>
		<result column="LEC_STATUS"  property="lecStatus"/>
		<result column="EMP_NO" 	 property="empNo"/>
		<result column="SEM_NO" 	 property="semNo"/>
		<result column="COLL_NO" 	 property="collNo"/>
		<result column="DEPT_NO" 	 property="deptNo"/>
	</resultMap>
	
	<!-- 강의 등록하기 위한 학기 이름 컬럼 조회 -->
	<select id="getSemesterNameForRegLecture">
		SELECT SEM_YEAR
			, SEM_NO
			, SEMESTER
		FROM SEMSTER
	</select>
	
	<!-- 강의 등록 -->
	<insert id="insertLecture">
		INSERT INTO LECTURE (
			LEC_NO
			, LEC_NAME
			, LEC_SCORE
			, MAX_NUM
			, NOW_NUM
			, EMP_NO
			, SEM_NO
			, COLL_NO
			, DEPT_NO
		) VALUES (
			(SELECT 'LEC_'||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(LEC_NO, 5))), 0) +1,3,0) FROM LECTURE)
			, #{lecName}
			, #{lecScore}
			, #{maxNum}
			, #{nowNum}
			, #{empNo}
			, #{semNo}
			, #{collNo}
			, #{deptNo}
		)
	</insert>
	
	<!-- 강의 목록 조회 -->
	<select id="getLectureList" resultType="HashMap">
		SELECT LEC_NAME
			, LEC_SCORE
			, COLL_NAME
			, DEPT_NAME
		FROM LECTURE LEC, DEPT, COLLEAGE COLL 
		WHERE LEC.DEPT_NO = DEPT.DEPT_NO
		AND LEC.COLL_NO = COLL.COLL_NO
	</select>
</mapper>



























